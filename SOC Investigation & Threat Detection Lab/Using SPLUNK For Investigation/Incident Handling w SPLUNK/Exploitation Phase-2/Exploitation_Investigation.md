#  Exploitation Phase Investigation – Web Server `imreallynotbatman.com`

---

##  Investigation Context

From the **Reconnaissance Phase**, we identified:

- Two IP addresses sending requests to the webserver
- IP `40.80.148.42` performing scanning activity
- Scanning originated from host `192.168.250.70`
- The attacker used the **Acunetix** web vulnerability scanner

The goal of this phase is to determine whether the attacker successfully exploited the application and gained access to the CMS admin panel.

---

##  Step 1 — Request Count by Source IP

**Search Query**
```
index=botsv1 imreallynotbatman.com sourcetype=stream*
| stats count(src_ip) as Requests by src_ip
| sort - Requests
```

**Purpose**
- Identify which IP generated the highest traffic volume
- Detect suspicious request bursts

---

##  Step 2 — Inbound Traffic to Webserver

**Search Query**
```
index=botsv1 sourcetype=stream:http dest_ip="192.168.250.70"
```

**Findings**
- Three IPs observed sending traffic (1 local + 2 remote)
- Indicates multiple clients interacting with the webserver

---

##  Step 3 — Identify HTTP POST Requests

**Search Query**
```
index=botsv1 sourcetype=stream:http dest_ip="192.168.250.70" http_method=POST
```

**Observation**
- Majority of requests were **POST**
- Suggests credential submission or form interaction attempts

---

##  Step 4 — Identify CMS Login Portal Traffic

The Joomla admin login page was identified as:

```
/joomla/administrator/index.php
```

**Search Query**
```
index=botsv1 imreallynotbatman.com sourcetype=stream:http dest_ip="192.168.250.70"
uri="/joomla/administrator/index.php"
```

**Purpose**
- Investigate authentication attempts against the admin portal

---

##  Step 5 — Examine Login Form Submissions

**Search Query**
```
index=botsv1 sourcetype=stream:http dest_ip="192.168.250.70"
http_method=POST uri="/joomla/administrator/index.php"
| table _time uri src_ip dest_ip form_data
```

**Finding**
- Single username `admin`
- Multiple password attempts
- Short time gap between attempts → Automated brute force

---

##  Step 6 — Filter Username & Password Attempts

**Search Query**
```
index=botsv1 sourcetype=stream:http dest_ip="192.168.250.70"
http_method=POST uri="/joomla/administrator/index.php"
form_data=*username*passwd*
| table _time uri src_ip dest_ip form_data
```

---

##  Step 7 — Extract Passwords Using Regex

**Search Query**
```
index=botsv1 sourcetype=stream:http dest_ip="192.168.250.70"
http_method=POST form_data=*username*passwd*
| rex field=form_data "passwd=(?<creds>\w+)"
| table _time src_ip uri http_user_agent creds
```

**Key Findings**
- Continuous brute-force attempts from `23.22.63.114`
- Python script used for automation
- One successful login attempt from `40.80.148.42` using Mozilla browser
- Correct password identified: **batman**

---

##  Investigation Summary

| Phase | Observation |
|------|-------------|
| Targeted URI | /joomla/administrator/index.php |
| Username Targeted | admin |
| Unique Password Attempts | 412 |
| Brute Force Source IP | 23.22.63.114 |
| Successful Login IP | 40.80.148.42 |
| Valid Password | batman |

---
##  MITRE ATT&CK Mapping

| Tactic | Technique | ID |
|--------|-----------|----|
| Initial Access | Exploit Public-Facing Application | T1190 |
| Credential Access | Brute Force | T1110 |
| Credential Access | Password Guessing | T1110.001 |
| Execution | Command and Scripting Interpreter | T1059 |
| Defense Evasion | Automated Exfiltration/Scripted Activity | T1027 |

---

##  Lessons Learned

- CMS admin portals are high-value targets for attackers
- Brute-force attacks often generate large POST request volumes
- Automated tools can be detected via abnormal request frequency
- User-Agent analysis helps differentiate manual vs automated attacks
- Regex extraction is critical for credential analysis in SIEM

---

##  Detection & Prevention Improvements

- Implement account lockout policies after repeated failures
- Deploy Web Application Firewall (WAF) rules for brute-force detection
- Enforce MFA on CMS admin accounts
- Monitor excessive POST requests to authentication endpoints
- Alert on automated User-Agent patterns (Python scripts)

---